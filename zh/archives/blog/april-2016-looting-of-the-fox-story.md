---
title: Looting of the Fox - The Story of Sabotage at ShapeShift
description: This is the story of how ShapeShift was betrayed. Not once, not twice, but three times in less than a month.
published: true
date: 2022-01-12T12:11:18.019Z
tags: archives, funds, hacks, looting, shapeshift, shapeshift history, stolen funds
editor: markdown
dateCreated: 2021-12-13T11:27:32.009Z
---


# 背景故事
自 2014 年春季成立以来，ShapeShift 一直是一个不断进化的产品。最初是一种在比特币和莱特币之间交换的快速实验形式，后来发展成为一种先进的引擎，可以轻松交换所有主要区块链资产，相互之间没有用户摩擦。没有用户帐户。没有注册过程。它是加密货币的谷歌翻译。

我们一直在追赶。试图以超过这个行业的速度构建技术，不仅沿着比特币本身的垂直方向，而且沿着所有加密货币的广度，这是一个挑战。

去年秋天，我们意识到最初为 ShapeShift 建立的“最小可行产品”服务器架构是不够的。我们需要一个专业人士加入这个小团队，并制作一个可扩展、安全的服务器设备，我们的技术可以在此基础上发展。

我们聘请了这样的人，并为我们的主动决定给了自己大大的夸赞。在简历上，他看起来很棒；我们致电的推荐人证实了他之前的角色和职责。他甚至从 2011/2012 年就开始接触比特币，并在他的房间里建造了矿工。这令人惊叹。我们称这位新员工为鲍勃……实际上他的真名以 B 开头。

在接下来的几个月里，Bob 构建并管理了 ShapeShift 的基础设施。他做得还不错，没什么特别突出的地方，但我们满足于拥有一名专业人士来处理 DevOps，至少足以让我们的工程师能够在架构上安心进行构建。

今年第一季度，随着市场发现我们已经知道的事情——我们的世界将成为众多区块链资产中的一个，每个资产都需要流动性——ShapeShift 的交易量激增。特别是以太坊正在崛起。我们的基础设施还没有为增长速度做好准备。就像骑自行车，喷气发动机突然全力推荐。

不幸的是，鲍勃几乎没有起到帮助作用。当队长长时间工作以保持船里的成员在一起时，他漫无目的地四处游荡。

从头开始，实际上，鲍勃并非漫无目的，他别有用心。

他正准备从我们这里偷东西。

# 创世纪的背叛
3 月 14 日上午，在我们有史以来成交量最大的一周中，我接到了我们的运营主管 Greg 的电话。“Erik，我们的热钱包丢失了 315 个比特币。” 我问，为什么我们的热钱包里有这么多东西？好吧，随着交易量的激增，我们的热钱包金额将在一个小时内通过正常业务耗尽，然后需要不断手动转入金额来重新平衡。有没有办法自动化保持资金平衡并降低这种风险？绝对有......但事后看来，一个人总是会会忘记抬头看路。

所以 315 个比特币不见了。

对于经历过此类事件的人来说，病痛的感觉是深刻的。这是一种深刻的、令人沮丧的状态，不会停留在经济损失的层面，而是渗透到一个人的内心。当系统遭到破坏时，人们精心设计和关心的系统被破坏，被信任的事情是非常非常难受的。然后是损失本身。315 个比特币……大约 130,000 美元。那是一笔大学学费，房子的一部分，十年的食物……几个月的工资单。对于盈利前的初创公司来说，这是一大笔钱。

我冲到办公室，希望别有什么其他错误。唯一令人欣慰的是，损失的只是我们自己的钱。没有客户账户，客户资金和个人信息都不会受到黑客攻击。这是从 ShapeShift 一开始就设计好的；我们的信条之一。可就算附近没有人受伤，一拳打在自己脸上还是疼得要命。

我自己、Greg 和我们的两位首席工程师翻阅了日志和服务器，疯狂地试图弄清楚发生了什么。315 BTC 去了一个陌生的比特币地址，并停在那里。

事实上，它仍然坐在那里： `~https://blockchain.info/address/1LchKFYxkugq3EPMoJJp5cvUyTyPMu1qBR~`

尽管我们通知所有员工紧急进入办公室，但我们负责安全和基础设施的 IT 主管 Bob 还是在上午 11:30 到达。

我们请鲍勃加入我们的讨论。我们向他透露了黑客的事情。我们问他那天早上是否登录过，他回答没有（多次）。对于盗窃案的最新消息，他似乎既不震惊也不愤怒，但让我们失望的是他的安全意识。立即，他开始推脱责任，“这一定是被黑客入侵的交易所之一，这种情况一直在发生。” 嗯，我们的交易所账户很好，鲍勃。

“好吧，看看 IP 地址，它发生在西非的某个地方。” 嗯，区块浏览器上的 IP 地址仅表示注意到交易的第一个节点，并且在比特币的上下文中通常没有意义，鲍勃。（什么样的比特币人不知道这一点？）

很快，我们意识到他几乎没用。在这里，我们有我们的“工具人”，他对自己的基础设施遭到黑客攻击的智能评论为零。

然而，在倾倒日志时，我们注意到几个 SSH 密钥（属于 Bob）在恶意交易前一小时早上登录到被破坏的服务器，然后在两分钟后注销。不一定是邪恶的，因为确实预计 Bob 的密钥会定期登录，尽管时间很奇怪（早上 6 点左右）。我们还发现漏洞发生在 VPN 上，这意味着办公室中的某个人或可以访问我们 VPN 的人实施了盗窃。

我们要求每个拥有服务器访问权限的人提供他们 SSH 密钥的指纹，以便我们可以开始将它们与日志进行比较。每个人都这样做，但另一个奇怪的事情是：Bob 上交的钥匙的指纹没有出现在任何日志中。它看起来是全新的。奇怪的是服务器管理员的密钥永远不会在任何服务器上看到......

不久之后，Bob 决定午休时间到了，在 ShapeShift 历史上最严重的事件中，我们有一个小时没有见到他了。坦率地说，我们不太在意，他没有提供帮助，而且怀疑他的想法开始蔓延。他告诉我们所有人，他将笔记本电脑打开以下载一些日志，并确保我们看到笔记本电脑是打开的。他有点奇怪。

一个小时后他回来时，他正和其他工程师坐在一起，他们仍在调查发生了什么。我在另一个房间打电话。当我结束通话时，我来查看进度。鲍勃似乎接到了“来自需要去医院的母亲”的电话。他收拾好东西，抓起他在办公室的狗，然后出去了。他的离去让我们一半松了口气，一半敬畏……我们的服务器管理员真的是我们调查期间第二次离开，他应该做这个管理员吗？

他说：“我一个小时内回来。” 这是 3 月 14 日下午 3 点左右。

我们再也没有见过他。

在他离开后不久，我们的一位工程师把我和 Greg 拉到一边说：“当你打电话时，我们都围坐在桌子旁，我们在日志中看到 Bob 在他坐着的时候删除了两个 SSH 密钥。和我们在一起，然后他为他们搜索了几次 [服务器命令来查找特定文本]，然后他离开了。这两个密钥与我们今天早上在日志中看到的两个密钥相匹配，这些密钥在黑客入侵之前访问了比特币服务器。”

他刚刚从服务器上删除了他的密钥？？好吧他妈的。枪支没有比这更冒烟的了。

我们都立即假设鲍勃偷了资金。他不在大楼里，所以我们开始锁定一切。所有的密码都被匆忙更改（嗯，几乎所有）。

我们又工作了几个小时，鲍勃没有消息。没有电话，没有短信，什么都没有。到了一天结束的时候，距离他离开去“送妈妈去医院”已经3-4个小时了。我们决定打电话给他，暂时还没有放过我们的怀疑。

> “嘿，鲍勃，你在哪儿？”
> 
> “哦，嘿，我刚决定回家。”
> 
> “你在家吗？”
> 
> “是的，就在这里，处理一些事情。”

那个电话是无害的，但我们记录了它。我们还记录了 30 分钟后的下一个，我们在其中向他提供了一些证据。

“所以鲍勃，看起来你删除了你的 SSH 密钥，并给了我们一个从未访问过任何服务器的新密钥。”

“是的，我删除了它们，因为我认为它们并不重要。”

是的，他确实是这么说的。我们的服务器管理员在调查 130,000 美元的盗窃案中，删除了他的两把钥匙，只有这两把钥匙，没有告诉任何人，然后在我们的电话中承认他这样做是因为“它们并不重要”。

碰巧这两个密钥是那天早上登录比特币服务器的确切密钥，并且在盗窃交易两分钟后注销。确实不重要！

他没有解释他那天的行为或行为，而是绕着问题胡说，一开始巧妙地暗示我们是种族主义者，然后更明确地暗示我们是种族主义者。

“嗯，鲍勃，我们瞄准你是因为你的密钥在服务器上，你删除了它们并在积极调查期间离开了。”

就这样持续了 45 分钟。他说其他可笑的话，都记录下来了。

我们发现了更多的证据细节，在确切地知道发生了什么以及谁负责后，我们松了一口气。我们花了晚上剩下的时间记录一切，并准备对鲍勃提出民事和刑事指控。

> 那天晚上我给了他最后一次救赎的机会。在给所有员工的信息中，为给他发了段话：
> 
> 这是你摆脱的机会，吸取教训，让这一切结束。如果在上午 10 点之前在此地址中发现 315 个比特币，我们将不会采取法律行动。不会再问任何问题，我们可以友好地分道扬镳。在此处发送 315 BTC：35JBgzjyCUPswjRP9iqrUTkkX76QwrKkB9 -Erik

我在凌晨 4 点 36 分收到 Bob 的回复消息，“我没有删除任何密钥，我定期登录服务器进行检查。”

是的，除了我们已经记录在案的：他说他确实删除了密钥并且那天早上没有登录。他在撒谎方面的无能似乎只有他在服务器管理方面的无能 才能胜过。

他继续，带着迷人的青春光彩

> “当然，责备我是种族主义行为……你基本上是在寻找借口来满足你的种族主义。与您在 SEC 的情况不同，我没有犯罪记录。”

第二天早上，我们的法律总顾问给 Bob 写了一封正式信件（通过电子邮件和邮寄），概述了我们知道的一些证据，并要求归还被盗财产。它还通知鲍勃他的工作被终止（我认为这是公平的，考虑到）。作为回应，鲍勃给律师发了一封电子邮件，没有提及任何证据，“你的客户是种族主义者，所以确保你知道你在和谁打交道。”

这就像他在现实生活中戴着他的网络巨魔帽子一样。他难道连事情的严重性都没有意识到吗？嗯……荒谬才刚刚开始。

在接下来的几天里，我们提交了正式的民事投诉。鲍勃给我们的地址是一个邮政信箱，但我们有他的法定姓名、银行信息和社会农奴编号。我们聘请了一名私家侦探。我们在几天内找到了他的公寓。几次服务尝试都失败了，但调查员听到门后传来狗叫声。他的一辆汽车被发现；他驾驶着两辆没有标记的退役警车。

我有一些投资者，我对他们进行了一定程度的协议调查，因此，我们还为刑事案件做出了安排，在此，盗窃构成了 3 级重罪，可判处 4-12 年监禁。老实说，我不在乎他是否受到惩罚。我关心我们是否变得完整，以及他是否意识到自己的错误并改变自己的生活成为一个更好的人。但还没有迹象表明。

我们学到了更多的东西。鲍勃之前在佛罗里达州有警察记录，他来自佛罗里达州。顺便说一下，记录表明他是白人。

随着针对他的民事和刑事案件继续进行，并且进一步发现鲍勃逃到佛罗里达州（将他的狗留给邻居暂时照顾......他现在想知道他在哪里并且几个星期没有收到他的消息），我们以为案子基本结案了。我们迟早会把他送到某个地方。并且，希望我们能归还我们被盗的财产，或者等价的法币。

# 罗维昂
我们一直在努力构建一个新的服务器基础设施，以在 Bob 之后建立一个新的服务器基础设施，假设他在我们系统中的工作在很大程度上受到了损害。我们与一家名为 CloudCo 的公司建立了一个新的云架构。

现在是 4 月 4 日那一周，我们已经准备好使用这个新的云基础架构。然后所有的地狱都崩溃了。再次。

4 月 7 日星期四中午左右，我们注意到一堆以太坊已经离开了 CloudCo 新基础设施的热钱包。新的基础设施。甚至还没有公开的基础设施。起初，我们认为我们的代码做了一些奇怪的事情，可能是将资金转移到开发服务器地址或类似地址。然后我们注意到一堆比特币也丢失了。然后也是莱特币。

小偷的比特币地址： `14Kt9i5MdQCKvjX6HS2hEevVgbPhK13SKD`

小偷的以太坊地址： `0xC26B321d50910f2f990EF92A8Effd8EC38aDE8f5`

小偷的莱特币地址：` LL9jqgXVqxUbWbWVaJocBcF9Vm8uS3NaTd`

现实很快就会打击你，这就是闪回的感觉。可怕的下沉感立刻再次袭来。他妈的怎么了？

不知何故，甚至不在公开服务器上的密钥已被泄露。我们在调查期间关闭了系统，包括我们的现场制作站点。我们没有像一个月前的黑客那样损失那么多，因为我们会保持钱包有点保守，但它仍然相当多。我们简直不敢相信。使用全新基础设施生成的全新密钥怎么会受到损害？

经过几个小时无果而终的调查，我们认为最可能的解释之一是云公司本身受到了损害。这在比特币领域之前已经发生过。我们认为 CloudCo 有信誉，但谁知道呢？云非常方便且可扩展，但在某种程度上，您信任该公司的基础架构。我们决定必须将站点关闭至少 24 小时，并全力以赴准备在一组全新的服务器上再次构建全新的基础架构。

几乎与损失的钱一样糟糕的是不知道它是如何发生的。日志没有按照应有的方式完成，因此它们被证明是徒劳的。确实，他们已经被抹去了。

尽管如此，我们还是观察了被黑资金的区块链。我们跟踪了一些到一个交换帐户。我们得到了存款人的资料。

姓名：Rovion Vavilov
电子邮件：rovion.vavilov@riseup.net
地址：莫斯科Chayanova St. 15
出生日期：1980 年 2 月 2 日
电话：+7 9625148445

那个人资料信息可能是假的，但那天晚上我给他发了电子邮件。

发件人：Erik Voorhees erik@shapeshift.io
收件人：rovion.vavilov@riseup.net
主题：ShapeShift Hack……

“在黑客方面做得很好。你是怎么做到的？-埃里克”

专业提示：不管他们的行为有多么不道德，黑帽子都喜欢因其技能而得到认可。像成年人一样冷静地与他们交谈。他们可能会透露信息，或以某种方式提供帮助。这很奇怪，但它发生了。无论如何，我没想到我的电子邮件会收到任何消息。

那天晚上剩下的时间，一直到第二天（星期五，8 日），该团队在一个完全独立的主机上的完全干净的环境中再次在新的基础设施上进行了狂热的重建工作。

现在对许多人来说，ShapeShift 似乎是一个简单的 Web 服务。为了保持这种外观，我们的工程师付出了很多努力。在幕后，平台是复杂的。超过 1,400 个直接资产交易对，与需要所有提供的加密货币的实时价格信息的六个交易所 API 集成，向数十个合作伙伴提供低延迟服务 API，监控和计算不断变化的汇率和某些订单深度地球上最不稳定的市场，以及在各种混乱状态下只能被描述为 alpha 级软件（硬币守护进程......

事实上，在比特币乐园中，并没有指南。

诚然，作为我自己的非工程师，我只能偶尔瞥见我们正在建造的东西的壮丽。我希望我能得到信任。对于阅读本文的我们的团队来说，您设计了一台了不起的机器，应该为此感到非常自豪。

现在这里是故事深入的地方

周五中午左右，黑客回复了我的电子邮件（记得我曾问过他是怎么做到的......）

发件人：rovion.vavilov@fastmail.com（注明新域名）
收件人：Erik Voorhees erik@shapeshift.io
主题：ShapeShift Hack……

“一个字：鲍勃”

这是第一封电子邮件的全部内容，但我们惊呆了。有那么一刻，我们想，“鲍勃是黑客吗？” 很快，这个想法让位于更可能的答案：鲍勃将我们的信息出售或泄露给黑客，然后黑客利用了它。

鲍勃背叛了我们。他背叛了自己的特权地位，直接从信任他的人的毁灭中获利。他偷窃、撒谎、逃跑，然后在得到足够长的时间反思他的行为后，决定再次背叛我们，以在他可怜的碗里多吃几口。黑客会进行黑客攻击，但需要某些混蛋才能晋升到值得信赖的职位，与团队面对面工作，从团队中获得薪水和信心，然后将他们全部搞砸，几乎没有钱买一辆特斯拉。哦，是的，然后抛弃一只狗独自挨饿，很可能很快就会被动物服务部门制止。

当心这些人在你的生活中。如果您怀疑他们，请迅速断绝关系。

无论如何，经过艰苦的努力，我们在 24 小时后的星期五晚上准备好了一切。我们在一个新的提供商上启动了该站点，我们将其称为 HostCo。尽管存在一些小故障，但系统仍在运行。我们已经向公众通报了这次黑客攻击，并决定在我们稍后更详细地研究受感染环境后发布更多详细信息。

兑换单立即开始。我们松了一口气。我在凌晨 1 点左右睡着了，睡得很安稳，从磨难中筋疲力尽，为团队感到非常自豪。

然后是星期六早上 9 点，我开始从沉睡中醒来。我的电话响了。是格雷格。

“我们又被黑了。从 HostCo 热钱包中取出的比特币和以太坊。”

我在电话里沉默。我只是在想，“这他妈是天启吗？！？”

这似乎不可能。两天前的黑客攻击似乎不可能，而现在这只是非常令人困惑和沮丧。我告诉 Greg 再次关闭该站点，我会在 30 分钟后给他回电。我们到底要如何向社区、我们的客户……向我们的投资者解释这一点？我们如何向自己解释呢？

我从床上起来，没有惊慌失措，只是觉得彻底失败了。我洗了一生中最糟糕的淋浴。愤怒包围着我……我们从黑客的电子邮件中知道鲍勃卷入其中，我们知道鲍勃对我们犯下了 3 级重罪，当局大约在三周前就知道了这一点，我们的私家侦探提供了立即定罪所需的所有信息。而现在这发生了。

当我整理思绪时，我决定是时候调用一些人脉资源了。

Ledger Labs 安全和调查服务主管兼 CCSS 董事会指导委员会主席 Michael Perklin 在我的名单上排名第一。他在多伦多，并同意当晚飞出去见我们。他正在去医院的路上；他的脚趾骨折了。他改变航线，前往机场。他多么坚韧啊。

我还与几个主要交易所的负责人进一步交谈。他们都不喜欢小偷，而且都乐于助人。尽管这个行业节奏很快，意见和兴趣也各不相同，但在需要的时候还是会走到一起。

于是回收了 1500 ETH，交易所正在寻找更多。小偷可能对此感到不安……毕竟被偷走很糟糕。

# 与小偷的炉边谈话
与此同时，我又通过电子邮件收到了小偷的来信。我通过询问他是否愿意提供更多信息来回应他的“一个词：鲍勃”消息。他提到，他可能会因此付出代价。

“嗨”他说。

我安排向他支付 2 BTC 以获取信息。

“我需要知道你和鲍勃的关系是什么”我问。我尽量避免先发制人的细节。

他回答说：“我得到信息说 Bob 在我试图黑掉你的时候也‘黑了’你。在 Bob 黑掉你之前我有一些访问权限，但还不足以让我自己拿到硬币。”

“你对鲍勃黑我们有什么了解？” 我问

“内部工作。315 比特币。” 他回答。“在鲍勃拿走硬币后，我与他交谈，问他我也如何破解它。他给了我更多关于基础设施和一些钥匙的信息。”

我问：“他为什么要给你信息，你给了他什么？”

Rovion 回应说：“因为我提供了 BTC。IP 地址、服务器角色、用户、有效的 SSH 密钥。已经不行了。”

我们进一步聊天，他透露了 Bob 与他通信的电子邮件：m0money@gmail.com。

虽然我之前没有看过那封电子邮件，但它似乎很熟悉。我想了一会儿，然后意识到 Bob 经常用 0 代替 o，包括他从服务器中删除的两个键之一（特定键被命名为某些东西，如果显示，会泄露 Bob 的真实姓名） . 那个，以及 Bob 的常见密码变体之一是“m0m0ney”这一事实。我们的安全人员使用 l33tspeak 作为他的密码。真正安全。

尽管鲍勃几周前偷了我们的资金这一点已经很明确了，但现在很明显，这个黑客 Rovion 正在向我们提供有关鲍勃的信息，只有鲍勃或与他有过实际互动的人才能知道。

另一个想法，这个黑客真的从一开始就陷害了鲍勃吗？当然，也许，但鲍勃在 3 月 14 日回来的每一个动作都与这个解释背道而驰，特别是鲍勃在我们眼皮底下删除了他自己的钥匙，然后离开了办公室，再也没有回来。此处未列出的其他证据进一步反驳了该理论。

回到与 Rovion 的聊天……我问他获得了哪个“有效的 SSH 密钥”。“不关你的事，”他回答说，“但他告诉我他是从同事打开的笔记本电脑上得到的。”

哇。如果为真，这意味着 Bob 在 ShapeShift 工作期间，在他窃取资金之前的某个时间访问了同事的计算机并复制了一个密钥（或更多？）。我想知道他有没有预谋整件事？

我试图获得更多信息，但 Rovion 不受欢迎。他的最后一条消息……

> “你的数百万会救你，埃里克·沃希斯。再见，我将通过电子邮件发送。”

傍晚时分，我们的法医调查员迈克尔·珀克林 (Michael Perklin) 到了。我从机场接他。我们决定暂缓在我们的服务器中闲逛，直到他在那里。虽然黑客对他如何获得秘密信息有一个模糊的认识，但我们并不真正了解漏洞的具体细节。鲍勃离开后，钥匙被更改了，虽然我们发现了一个我们不记得要更改的钥匙，但它只能访问一个服务器，该服务器在前一个星期四不可能窃取资金。再说一次，它根本无法解释周六早上的盗窃事件是如何发生的。CloudCo 和 HostCo 的资金都被盗了，尽管它们是作为具有全新密钥的全新环境构建的。

迈克尔让我向他传达过去一个月的整个故事。他继续执行他的调查协议，其中包括假设公司中没有人值得信赖。很难说这个团队值得信赖，因为这一切都始于一个流氓员工。那是一种令人沮丧的感觉。

关于此类取证工作是如何完成的，这里可以添加许多有趣的细节，但篇幅有限，揭示每一种此类方法可能是不明智的。过了一会儿，我们自己潜入日志中，首先查看周六日志。他们被删除了，其中大部分。他们是如何被删除的？我们不确定。

我们现在知道如何防止这种情况发生……确实，我们在整个事件中获得的经验非常宝贵。尽管这听起来很无聊，但如果您的初创公司涉及保护信息或服务器的任何内容，请帮自己一个忙，尽早引入第 3 方专业帮助。我们一开始并不需要它，因为我们还小。但是增长会悄悄地向您袭来，在您意识到之前，您正在使用不合标准的方法保护重要资产。

虽然大部分日志都消失了，但我们实际上使用取证技术从“空”磁盘空间本身恢复了其中的很大一部分。这只是幸运。也许中本聪的鬼魂正在寻找我们（当然，一周前可以使用他的帮助！）

从恢复的数据中，我们发现了恶意软件，如果这是正确的术语的话。有一个用 Go 编写的程序安装在与硬币通信的关键服务器上。该程序的日期更改为与服务器的设置一致，并且其文件名看起来无害。但它是资金被盗的直接工具。

udevd-bridge 它的昵称

我们很高兴找到它（是的，在 CloudCo 和 HostCo 这两个服务器环境中都出现了同样的事情）。但是，它仍然没有解释它是如何放在那里的。我们有很多信息，但不是整个故事。

再过几天我们就不会有完整的故事了。但后来星星对齐了。

突然之间，黑客 Rovion 于 4 月 13 日星期三再次给我发电子邮件。

发件人：Rovion Vavilov rovion.vavilov@fastmail.com
收件人：Erik Voorhees erik@shapeshift.io
主题：回复：ShapeShift

“您是否有兴趣以高折扣率购买我目前持有的 ETH 以换取 BTC？我愿意先少量交易，因为你没有理由相信我。”

是的，黑客似乎对他的以太坊在交易所不断冻结感到恼火。所以他回到他抢劫的商店，问我们是否会交易流动性更强的资产。我们基本上是买回我们自己的以太坊，然后支付给他比特币。

显然是值得的，如果我们能获得更多的信息。由于我们都不信任对方，我们建立了一个协议：

我们支付 2 BTC 以开始对话
Rovion 为我们提供了一半的相关信息
我们以 0.02 BTC/ETH 的汇率以 250, 2000 ETH 为增量兑换 BTC
Rovion为我们提供了下半年的相关信息
我们以相同的增量将剩余的 2500 ETH 换成 BTC
我们停止沟通（最后一个是 Rovion 的建议）
他要求我们将 BTC 发送到他已知的 BTC 地址：14Kt9i5MdQCKvjX6HS2hEevVgbPhK13SKD

在最初的 2 BTC 付款后，Rovion 开始描述 4 月 7 日的黑客攻击：

> “我们联系了鲍勃。他向我们提供了 ShapeShift 核心源代码、核心服务器 IP 地址、SSH 密钥和 [已编辑]。我使用提供的 SSH 密钥登录到核心服务器，安装了一个后门并获取了硬币，因为核心服务器可以通过 SSH 访问硬币服务器。”

“上面提到的SSH密钥的指纹是什么？” 我问

`“9c:3f:4b:ad:d6:43:ec:9a:55:de:b9:0b:d8:f5:0a:cb”`

我们看到它是 Greg 的密钥，是为 CloudCo 环境新创建的。直到 Bob 在 3 月份偷走资金并消失一个多星期后，它才存在。这位黑客究竟是如何获得新密钥的，鲍勃发布后？

我还询问了提到的“[编辑]”，但 Rovion 说这是第二批信息的一部分。我们继续进行第二批资金的增量兑换。

然后 Rovion 说，

> “[编辑] 是对 Bob 安装在同事机器上的 RDP 的访问。这就是我第二次黑你的方式。”

哇，现在它开始聚集在一起，每一个启示都剥去一层鲍勃的背叛。Bob 在 Greg 的计算机上安装了 RDP（远程桌面协议——基本上是一个屏幕查看器或控制器）。也许在其他人身上，我们必须假设。

然后 Rovion 通过 pastebin 分享 Bob 的一封电子邮件（他购买的信息）：

> “你好，
> 
> 我收到了你的 50 个比特币。gh 源和 ssh 私钥作为附件”
> 
> 核心IP：XX.XX.XX.XX
> 
> 转发路由器：XX.XX.XX.XX:XXXX
> 
> 管理员：[编辑密码]
> 
> rdp 内部 ip: XX.XX.XX.XX
> 
> 管理员：通过
> 
> 谢谢你的生意。
> 
> [列出了2个附件]

（特定 IP 由我们编辑）

就在那里。Bob 将有关生产服务器的信息、ShapeShift 内部网络的访问权、ShapeShift 源代码的一部分以及他安装在同事计算机上的 RDP 客户端的访问权以 50 比特币的价格出售给 Rovion。检出 IP 和内部路由器信息。

这几乎解释了一切。通过 RDP 访问 Greg 的计算机（可能还有其他计算机），可以见证新的服务器环境并可以使用新的 SSH 密钥。这不是云服务提供商的错，而是我们自己的错。

我们几乎改变了一切，但没有报废我们在 Bob 加入团队时使用的个人电脑。那会是偏执的事情吗？是的。这是正确的做法吗？

清楚地。

在我们结束讨论之前，Rovion 说的最后一句话之一，

> “即使我说停止沟通，当鲍勃被起诉/无论你打算做什么时，你还能给我发一封电子邮件吗？我觉得从你自己的雇主那里偷东西真的很糟糕。”
> 
# 清理一团糟
我们认为这些信息将有助于证明 Bob 的犯罪意图。这不是一时冲动，而是精心策划的背叛。我已经记不清此时所涉及的重罪数量了。

我们也知道，虽然 Rovion 的故事得到了证实，但它很可能不是完整的故事。我们必须假设其他细节与案例和我们的基础设施相关。这就是 ShapeShift 离线的时间比我们任何人希望的都要长的原因。我们非常小心，也非常偏执。

尽管如此，我还是为我的团队感到无比自豪。在一家初创公司工作，在比特币行业，压力已经够大了，然后要应对像这样的一系列分层背叛及其造成的所有损害（财务、技术、心理）……这很难。你们做得非常出色，看到团队的凝聚力和毅力，我深受鼓舞。

在这两起事件发生的一周内，我们刚刚引进了四名新员工（几乎使我们的开发人员增加了一倍），这无济于事。他们被毫不留情地投入了战斗，他们令人难以置信。

# 不影响 ShapeShift 用户
为了在比特币中生存，一个人必须是一个乐观主义者。虽然背叛、损失和清理工作非常繁重，但仍有一些一线希望。

首先，没有人或组织是完美的。我们学到了一些我们自己的弱点，以及我们自己的错误。我们正在纠正它们，并尽可能改进它们。这种改进并不便宜，但今天的 ShapeShift 比昨天的 ShapeShift 做得更好。钢是回火的，机器是精炼的。虽然没有一个组织可以最终实现它，但我们尝试接近反脆弱性，并将其作为我们工作中的理想例证。

其次，即使是内部人员精心策划的多次黑客攻击，也没有客户损失金钱。通过去中心化、通过代码、通过创新、通过结构……通过设计保护消费者是这个行业对社会最重要的贡献之一——这是一个世纪的传统银行业未能实现的，正如中本聪在创世纪区块中臭名昭著的一句话所指出的那样。

ShapeShift 将始终致力于在这个消费者保护平台上进行开发。这个社区中的许多其他人正在沿着不同的途径做同样的事情。感谢您构建的工具以及您所做的工作。事实上，还有很多事情要做。

对于我们的客户，我要亲自为我们的停机时间道歉。虽然我们可以确保您的资金没有风险，但我知道很多人依赖我们的服务，但它一直无法使用。即使面临灾难，冗余也将是我们未来的主要发展目标之一。

此外，衷心感谢社区中那些伸出援手并提供各种支持的人，以及非常善良和理解我们的投资者。

最后，就像一个人忍受的所有紧张事件一样，我们必须欣赏成长、体验和生命中最宝贵的奢侈品之一——反思的空间和机会。

在比特币乐园里从来没有无聊的一天。

> 对鲍勃……请注意，您的真实姓名和身份信息并未泄露。认为这是最后的，仅剩的礼貌。

Erik Voorhees，ShapeShift 首席执行官，2016 年 4 月 19 日